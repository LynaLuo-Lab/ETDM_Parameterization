#!/usr/bin/env python
import psi4,os,importlib
import numpy as np
mem="1000mb"
cpu=4
psi4.set_num_threads(cpu)
psi4.set_memory(mem)

psi4.core.set_output_file(os.path.dirname(os.path.abspath(__file__))+'/'+'.'.join(os.path.basename(__file__).split('.')[:-1])+'.out', False)




opttheory="hf"
optbasis="6-31g*"
options={'scf_type': 'df', 'g_convergence':'gau','freeze_core':'true'}
psi4.set_options(options)


psi4_xyz="""
1 1
N    	-0.565384	-1.098640	0.031049
N    	-5.361689	-1.229052	0.790998
N    	3.043383	3.729465	-0.727850
C    	0.593466	-0.432749	-0.137140
C    	-1.798428	-0.445239	0.161406
C    	0.619905	0.986909	-0.191820
C    	-1.815177	0.978530	0.138694
C    	-0.614292	1.704123	-0.130808
C    	-0.539349	-2.587104	0.090660
C    	1.859185	-1.193489	-0.242032
C    	-2.979298	-1.181060	0.395287
C    	1.844084	1.657588	-0.402839
C    	-3.080782	1.607247	0.262799
C    	-0.548430	3.115612	-0.210073
C    	-4.203841	-0.532658	0.513374
C    	1.877612	3.049171	-0.479621
C    	-0.563821	-3.091028	1.526533
C    	-4.228522	0.886000	0.483803
C    	0.648791	3.763313	-0.417760
C    	2.600692	-1.477855	0.914678
C    	2.349460	-1.561797	-1.504692
C    	3.815846	-2.156807	0.806072
C    	3.562774	-2.244734	-1.601324
C    	4.294321	-2.544310	-0.448390
H    	-1.385268	-2.942805	-0.498074
H    	0.366751	-2.907844	-0.418503
H    	-2.972555	-2.262455	0.452098
H    	2.768866	1.090763	-0.459737
H    	-3.147670	2.689679	0.251346
H    	-1.453312	3.713072	-0.172721
H    	0.354276	-2.801335	2.040777
H    	-0.620801	-4.183324	1.521613
H    	-1.417005	-2.701533	2.084770
H    	-5.178188	1.404828	0.596798
H    	0.663940	4.848923	-0.498029
H    	2.237193	-1.152858	1.887726
H    	1.782062	-1.315824	-2.400497
H    	4.391044	-2.378569	1.701267
H    	3.940499	-2.536019	-2.577935
H    	-6.234345	-0.757501	0.584718
H    	-5.379887	-2.210951	0.541772
H    	3.914542	3.248455	-0.540923
H    	3.067728	4.715547	-0.500295
H    	5.239825	-3.073886	-0.528376

"""
mol=psi4.geometry(psi4_xyz)
mol.update_geometry() # This update is required for psi4 to load the molecule
E=psi4.energy(opttheory+"/"+optbasis)
psi4.core.print_out('INTERACTION MONOMER ENERGY is : '+str(E) )