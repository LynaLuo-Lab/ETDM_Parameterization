#!/usr/bin/env python
import psi4,os,importlib
import numpy as np
mem="1000mb"
cpu=4
psi4.set_num_threads(cpu)
psi4.set_memory(mem)

psi4.core.set_output_file(os.path.dirname(os.path.abspath(__file__))+'/'+'.'.join(os.path.basename(__file__).split('.')[:-1])+'.out', False)


psi4_xyz="""
1 1
N    	0.619000	-0.936000	-0.596000
N    	4.745000	-1.629000	2.024000
N    	-2.159000	3.926000	-0.088000
C    	-0.510000	-0.260000	0.045000
C    	1.891000	-0.384000	-0.124000
C    	-0.565000	1.262000	-0.140000
C    	1.810000	0.998000	0.502000
C    	0.836000	1.848000	-0.272000
C    	0.626000	-0.878000	-2.068000
C    	-1.809000	-1.035000	-0.067000
C    	2.634000	-1.338000	0.794000
C    	-1.315000	1.902000	1.018000
C    	3.189000	1.575000	0.714000
C    	0.970000	3.341000	-0.116000
C    	4.018000	-0.780000	1.095000
C    	-1.325000	3.412000	0.983000
C    	-0.494000	-1.660000	-2.745000
C    	4.008000	0.654000	1.598000
C    	0.071000	3.982000	0.909000
C    	-3.085000	-0.351000	0.357000
C    	-1.723000	-2.441000	0.490000
C    	-4.316000	-1.126000	-0.065000
C    	-2.988000	-3.245000	0.263000
C    	-4.032000	-2.528000	-0.570000
H    	0.615000	0.155000	-2.435000
H    	1.566000	-1.321000	-2.422000
H    	2.736000	-2.315000	0.307000
H    	-0.970000	1.541000	1.993000
H    	3.708000	1.786000	-0.226000
H    	0.916000	3.855000	-1.079000
H    	-1.464000	-1.169000	-2.625000
H    	-0.299000	-1.727000	-3.820000
H    	-0.559000	-2.681000	-2.356000
H    	3.674000	0.733000	2.638000
H    	0.546000	4.049000	1.892000
H    	-3.113000	-0.166000	1.436000
H    	-1.458000	-2.443000	1.552000
H    	-4.888000	-0.556000	-0.802000
H    	-2.736000	-4.210000	-0.185000
H    	4.784000	-2.581000	1.662000
H    	5.711000	-1.313000	2.094000
H    	-3.100000	3.543000	-0.004000
H    	-1.806000	3.617000	-0.993000
H    	-4.961000	-3.107000	-0.568000

symmetry c1
no_reorient
no_com

"""
mol=psi4.geometry(psi4_xyz)
mol.update_geometry() # This update is required for psi4 to load the molecule


opttheory="mp2"
optbasis="6-31g*"
options={'scf_type': 'df', 'g_convergence':'gau','freeze_core':'true'}
psi4.set_options(options)


psi4.optimize(opttheory+"/"+optbasis,mol=mol)
psi4.core.print_out("Dipole START\n")
dipobasis="6-31g*"
dipotheory="mp2"
psi4.prop(dipotheory+"/"+dipobasis, properties=["DIPOLE"])
psi4.core.print_out("Dipole END\n")
